{
    "$schema" : "https://json-schema.org/draft/2020-12/schema",
    "$id" : "https://cybersecuritypoet.github.io/koala-json-schema/host.schema.json",
    "title" : "Host definition",
    "description" : "",
    "type" : "object",
    "additionalProperties" : false,
    "anyOf":
    [
        { "properties" : { "skip" : { "const": true } } },
        {
            "allOf" :
            [
                {
                    "required" : ["name","type"]
                },
                {
                    "if" :
                    {
                        "properties" : { "type" : { "const": "Virtual" } }
                    },
                    "then" :
                    {
                        "required" : ["vm_id","vm_uuid","hypervisor"]
                    }
                },
                {
                    "if" :
                    {
                        "properties" : { "type" : { "not" : { "const": "External" } } }
                    },
                    "then" :
                    {
                        "required" : ["os","networks"]
                    }
                }
            ]
        }
    ],
    "properties":
    {
        "skip":
        {
            "type" : ["boolean","null"],
            "description" : "Skip loading object."
        },
        "name":
        {
            "type" : "string",
            "description" : "Host name",
            "pattern" : "^[a-zA-Z0-9_\\-]+$"
        },
        "desc":
        {
            "type" : ["string","null"],
            "description" : "Objects description."
        },
        "templates":
        {
            "type" : ["array","null"],
            "description" : "Templates to be applied to the object.",
            "items" :
            {
                "type" : "string"
            }
        },
        "hostname":
        {
            "type" : ["string","null"],
            "description" : "Hostname override."
        },
        "type":
        {
            "type" : ["string","null"],
            "description" : "Host type.",
            "enum" : [
                        "RPi4",
                        "x86",
                        "Mikrotik-CRS112-8P",
                        "Mikrotik-hEX-PoE",
                        "Mikrotik-wAP-AC-IPQ4018",
                        "Mikrotik-wAP-AC-IPQ4019",
                        "Mikrotik-wAP-AC-QCA9556",
                        "Mikrotik-RBLHGR",
                        "Mikrotik-Audience",
                        "Mikrotik-CRS328-24P-4S",
                        "Mikrotik-CRS326-24G-2S",
                        "Mikrotik-CRS317-1G-16S",
                        "Mikrotik-mAP-lite",
                        "Mikrotik-cAP-lite",
                        "Mikrotik-RB5009U",
                        "Lenovo_M93p_tiny",
                        "Dell_Wyse_5070",
                        "MFF_x86",
                        "APC_NMC2",
                        "Virtual",
                        "External"]
        },
        "os":
        {
            "type" : ["string","null"],
            "description" : "OS the host will run.",
            "enum" : ["Slackware-15","RouterOS6","RouterOS7","SlackwareAARCH64-15","APC_NMC_AOS_7"]
        },
        "pn":
        {
            "type" : ["string","null"],
            "description" : "P/N"
        },
        "sn":
        {
            "type" : ["string","null"],
            "description" : "S/N"
        },
        "domain":
        {
            "type" : ["string","null"],
            "description" : "Override host domain deduction."
        },
        "hypervisor":
        {
            "type" : ["string","null"],
            "description" : "Assign hypervisor to host."
        },
        "trunk_if":
        {
            "type" : ["string","null"],
            "description" : "Use particular NIC by default when creating VLAN interfaces and virtual switches."
        },
        "default_vswitch":
        {
            "type" : ["string","null"],
            "description" : "Use particular vswitch by default for VM connections."
        },
        "NICs":
        {
            "type" : ["array"],
            "description" : "List of NICs to be configured/created.",
            "items":
            {
                "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/host.nic.schema.json"
            }
        },
        "networks":
        {
            "type" : ["array"],
            "description" : "List of networks to add to the host.",
            "items":
            {
                "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/host.network.schema.json"
            }
        },
        "ports":
        {
            "type" : ["array"],
            "description" : "List of ports to add to the host.",
            "items":
            {
                "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/host.port.schema.json"
            }
        },
        "services":
        {
            "type" : ["array"],
            "description" : "List of services to define for the host.",
            "items":
            {
                "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/service.schema.json"
            }
        },
        "bridges":
        {
            "type" : ["array"],
            "description" : "List of bridges defined for host.",
            "items":
            {
                "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/host.bridge.schema.json"
            }
        },
        "physical_connections":
        {
            "type" : ["array"],
            "description" : "List of physical connections between this host and others.",
            "items":
            {
                "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/host.physical_connection.schema.json"
            }
        },
        "firewall":
        {
            "type" : ["object"],
            "description" : "Host firewall configuration.",
            "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/host.firewall.schema.json"
        },
        "vm_id":
        {
            "type" : ["integer","null"],
            "description" : "VM ID, unique per hypervisor."
        },
        "vm_uuid":
        {
            "type" : ["string","null"],
            "format" : "uuid",
            "description" : "VM UUID, unique per hypervisor."
        },
        "smp":
        {
            "type" : ["integer","null"],
            "description" : "Number of physical threads for VM."
        },
        "memory":
        {
            "type" : ["string","null"],
            "description" : "Amounts of RAM memory assigned to the VM."
        },
        "vdisks":
        {
            "type" : ["array"],
            "description" : "List of virtual disks to add to the VM.",
            "items":
            {
                "$ref" : "https://cybersecuritypoet.github.io/koala-json-schema/host.vdisk.schema.json"
            }
        }
    }
}